{"version":3,"sources":["webpack:///bulbs-pinned-element.js","webpack:///./elements/bulbs-pinned-element/bulbs-pinned-element.js"],"names":["webpackJsonp","0","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_defaults","defaults","keys","Object","getOwnPropertyNames","i","length","key","value","getOwnPropertyDescriptor","configurable","undefined","defineProperty","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","setPrototypeOf","_register","_invariant","_invariant2","_util","BulbsPinnedElement","_BulbsHTMLElement","this","apply","arguments","attachedCallback","hasAttribute","selector","getAttribute","element","document","querySelector","lastPosition","animationRequest","window","addEventListener","handleScrollEvent","bind","_this2","requestAnimationFrame","InViewMonitor","isElementInViewport","getBoundingClientRect","elementPinnedTo","getElementPinnedTo","boundingRects","getBoundingRects","isScrollingDown","handleScrollDown","handleScrollUp","pinnedTo","parentElement","tagName","toUpperCase","offset","getScrollOffset","scrollDown","y","pinnedElement","pinnedParentTopInViewport","pinToParentTop","pinnedElementAtParentBottom","pinToParentBottom","addPinnedClass","pinnedElementAtParentTop","pinnedElementBelowTopOfViewport","el","elementTop","$","top","windowTop","pageYOffset","windowBottom","innerHeight","bottom","classList","remove","add","BulbsHTMLElement","registerElement","256"],"mappings":"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","file":"bulbs-pinned-element.js","sourcesContent":["webpackJsonp([13],{\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _register = __webpack_require__(2);\n\t\n\tvar _invariant = __webpack_require__(1);\n\t\n\tvar _invariant2 = _interopRequireDefault(_invariant);\n\t\n\tvar _util = __webpack_require__(189);\n\t\n\t__webpack_require__(256);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _defaults(obj, defaults) { var keys = Object.getOwnPropertyNames(defaults); for (var i = 0; i < keys.length; i++) { var key = keys[i]; var value = Object.getOwnPropertyDescriptor(defaults, key); if (value && value.configurable && obj[key] === undefined) { Object.defineProperty(obj, key, value); } } return obj; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass); }\n\t\n\tvar BulbsPinnedElement = function (_BulbsHTMLElement) {\n\t  _inherits(BulbsPinnedElement, _BulbsHTMLElement);\n\t\n\t  function BulbsPinnedElement() {\n\t    _classCallCheck(this, BulbsPinnedElement);\n\t\n\t    return _possibleConstructorReturn(this, _BulbsHTMLElement.apply(this, arguments));\n\t  }\n\t\n\t  BulbsPinnedElement.prototype.attachedCallback = function attachedCallback() {\n\t    (0, _invariant2.default)(this.hasAttribute('pinned-to'), '<bulbs-pinned-element pinned-to=\".selector\">: a pinned-to selector is required');\n\t\n\t    var selector = this.getAttribute('pinned-to');\n\t    var element = document.querySelector(selector);\n\t    this.lastPosition = 0;\n\t    this.animationRequest = null;\n\t\n\t    (0, _invariant2.default)(element, '<bulbs-pinned-element pinned-to=\".selector\">: no element with the selector \"' + selector + '\" is in the DOM');\n\t\n\t    window.addEventListener('scroll', this.handleScrollEvent.bind(this));\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.handleScrollEvent = function handleScrollEvent() {\n\t    var _this2 = this;\n\t\n\t    if (!this.animationRequest) {\n\t      this.animationRequest = requestAnimationFrame(function () {\n\t        _this2.animationRequest = null;\n\t\n\t        if (!_util.InViewMonitor.isElementInViewport(_this2, _this2.getBoundingClientRect())) {\n\t          return;\n\t        }\n\t\n\t        var elementPinnedTo = _this2.getElementPinnedTo();\n\t        var boundingRects = _this2.getBoundingRects(elementPinnedTo);\n\t\n\t        if (_this2.isScrollingDown()) {\n\t          _this2.handleScrollDown(elementPinnedTo, boundingRects);\n\t        } else {\n\t          _this2.handleScrollUp(boundingRects);\n\t        }\n\t      });\n\t    }\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.getElementPinnedTo = function getElementPinnedTo() {\n\t    var pinnedTo = this.getAttribute('pinned-to');\n\t    var elementPinnedTo = void 0;\n\t    if (this.parentElement.tagName.toUpperCase() === pinnedTo.toUpperCase()) {\n\t      elementPinnedTo = this.parentElement;\n\t    } else {\n\t      elementPinnedTo = this.parentElement.querySelector(pinnedTo);\n\t    }\n\t    return elementPinnedTo;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.isScrollingDown = function isScrollingDown() {\n\t    var offset = (0, _util.getScrollOffset)();\n\t    var scrollDown = false;\n\t    if (offset.y > this.lastPosition) {\n\t      scrollDown = true;\n\t    }\n\t    this.lastPosition = offset.y;\n\t    return scrollDown;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.getBoundingRects = function getBoundingRects(elementPinnedTo) {\n\t    return {\n\t      'pinnedElement': this.getBoundingClientRect(),\n\t      'elementPinnedTo': elementPinnedTo.getBoundingClientRect()\n\t    };\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.handleScrollDown = function handleScrollDown(elementPinnedTo, boundingRects) {\n\t    if (this.pinnedParentTopInViewport(elementPinnedTo)) {\n\t      this.pinToParentTop();\n\t    } else if (this.pinnedElementAtParentBottom(boundingRects)) {\n\t      this.pinToParentBottom();\n\t    } else {\n\t      this.addPinnedClass();\n\t    }\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.handleScrollUp = function handleScrollUp(boundingRects) {\n\t    if (this.pinnedElementAtParentTop(boundingRects)) {\n\t      this.pinToParentTop();\n\t    } else if (this.pinnedElementBelowTopOfViewport(boundingRects)) {\n\t      this.addPinnedClass();\n\t    }\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.pinnedParentTopInViewport = function pinnedParentTopInViewport(el) {\n\t    var elementTop = $(el).offset().top;\n\t    var windowTop = window.pageYOffset;\n\t    var windowBottom = windowTop + window.innerHeight;\n\t    return elementTop > windowTop && elementTop < windowBottom;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.pinnedElementAtParentBottom = function pinnedElementAtParentBottom(boundingRects) {\n\t    return boundingRects.pinnedElement.bottom >= boundingRects.elementPinnedTo.bottom;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.pinnedElementAtParentTop = function pinnedElementAtParentTop(boundingRects) {\n\t    return boundingRects.pinnedElement.top <= boundingRects.elementPinnedTo.top;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.pinnedElementBelowTopOfViewport = function pinnedElementBelowTopOfViewport(boundingRects) {\n\t    return boundingRects.elementPinnedTo.top < 0;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.pinToParentTop = function pinToParentTop() {\n\t    this.classList.remove('pinned-bottom');\n\t    this.classList.remove('pinned');\n\t    this.classList.add('pinned-top');\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.pinToParentBottom = function pinToParentBottom() {\n\t    this.classList.remove('pinned-top');\n\t    this.classList.remove('pinned');\n\t    this.classList.add('pinned-bottom');\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.addPinnedClass = function addPinnedClass() {\n\t    this.classList.remove('pinned-top');\n\t    this.classList.remove('pinned-bottom');\n\t    this.classList.add('pinned');\n\t  };\n\t\n\t  return BulbsPinnedElement;\n\t}(_register.BulbsHTMLElement);\n\t\n\texports.default = BulbsPinnedElement;\n\t\n\t\n\t(0, _register.registerElement)('bulbs-pinned-element', BulbsPinnedElement);\n\n/***/ },\n\n/***/ 256:\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }\n\n});\n\n\n// WEBPACK FOOTER //\n// bulbs-pinned-element.js","import { registerElement, BulbsHTMLElement } from 'bulbs-elements/register';\nimport invariant from 'invariant';\nimport { getScrollOffset, InViewMonitor } from 'bulbs-elements/util';\nimport './bulbs-pinned-element.scss';\n\nexport default class BulbsPinnedElement extends BulbsHTMLElement {\n  attachedCallback () {\n    invariant(this.hasAttribute('pinned-to'), '<bulbs-pinned-element pinned-to=\".selector\">: a pinned-to selector is required');\n\n    const selector = this.getAttribute('pinned-to');\n    const element = document.querySelector(selector);\n    this.lastPosition = 0;\n    this.animationRequest = null;\n\n    invariant(element, `<bulbs-pinned-element pinned-to=\".selector\">: no element with the selector \"${selector}\" is in the DOM`);\n\n    window.addEventListener('scroll', this.handleScrollEvent.bind(this));\n  }\n\n  handleScrollEvent () {\n    if(!this.animationRequest) {\n      this.animationRequest = requestAnimationFrame(() => {\n        this.animationRequest = null;\n\n        if(!InViewMonitor.isElementInViewport(this, this.getBoundingClientRect())) { return; }\n\n        let elementPinnedTo = this.getElementPinnedTo();\n        const boundingRects = this.getBoundingRects(elementPinnedTo);\n\n        if(this.isScrollingDown()) {\n          this.handleScrollDown(elementPinnedTo, boundingRects);\n        }\n        else {\n          this.handleScrollUp(boundingRects);\n        }\n      });\n    }\n  }\n\n  getElementPinnedTo () {\n    const pinnedTo = this.getAttribute('pinned-to');\n    let elementPinnedTo;\n    if(this.parentElement.tagName.toUpperCase() === pinnedTo.toUpperCase()) {\n      elementPinnedTo = this.parentElement;\n    }\n    else {\n      elementPinnedTo = this.parentElement.querySelector(pinnedTo);\n    }\n    return elementPinnedTo;\n  }\n\n  isScrollingDown () {\n    const offset = getScrollOffset();\n    let scrollDown = false;\n    if (offset.y > this.lastPosition) {\n      scrollDown = true;\n    }\n    this.lastPosition = offset.y;\n    return scrollDown;\n  }\n\n  getBoundingRects (elementPinnedTo) {\n    return {\n      'pinnedElement': this.getBoundingClientRect(),\n      'elementPinnedTo': elementPinnedTo.getBoundingClientRect(),\n    };\n  }\n\n  handleScrollDown (elementPinnedTo, boundingRects) {\n    if (this.pinnedParentTopInViewport(elementPinnedTo)) {\n      this.pinToParentTop();\n    }\n    else if (this.pinnedElementAtParentBottom(boundingRects)) {\n      this.pinToParentBottom();\n    }\n    else {\n      this.addPinnedClass();\n    }\n  }\n\n  handleScrollUp (boundingRects) {\n    if (this.pinnedElementAtParentTop(boundingRects)) {\n      this.pinToParentTop();\n    }\n    else if (this.pinnedElementBelowTopOfViewport(boundingRects)) {\n      this.addPinnedClass();\n    }\n  }\n\n  pinnedParentTopInViewport (el) {\n    let elementTop = $(el).offset().top;\n    let windowTop = window.pageYOffset;\n    let windowBottom = windowTop + window.innerHeight;\n    return elementTop > windowTop && elementTop < windowBottom;\n  }\n\n  pinnedElementAtParentBottom (boundingRects) {\n    return boundingRects.pinnedElement.bottom >= boundingRects.elementPinnedTo.bottom;\n  }\n\n  pinnedElementAtParentTop (boundingRects) {\n    return boundingRects.pinnedElement.top <= boundingRects.elementPinnedTo.top;\n  }\n\n  pinnedElementBelowTopOfViewport (boundingRects) {\n    return boundingRects.elementPinnedTo.top < 0;\n  }\n\n  pinToParentTop () {\n    this.classList.remove('pinned-bottom');\n    this.classList.remove('pinned');\n    this.classList.add('pinned-top');\n  }\n\n  pinToParentBottom () {\n    this.classList.remove('pinned-top');\n    this.classList.remove('pinned');\n    this.classList.add('pinned-bottom');\n  }\n\n  addPinnedClass () {\n    this.classList.remove('pinned-top');\n    this.classList.remove('pinned-bottom');\n    this.classList.add('pinned');\n  }\n}\n\nregisterElement('bulbs-pinned-element', BulbsPinnedElement);\n\n\n\n// WEBPACK FOOTER //\n// ./elements/bulbs-pinned-element/bulbs-pinned-element.js"],"sourceRoot":""}