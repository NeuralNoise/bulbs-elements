{"version":3,"sources":["webpack:///bulbs-pinned-element.js","webpack:///./elements/bulbs-pinned-element/bulbs-pinned-element.js"],"names":["webpackJsonp","0","module","exports","__webpack_require__","_defaults","obj","defaults","keys","Object","getOwnPropertyNames","i","length","key","value","getOwnPropertyDescriptor","configurable","undefined","defineProperty","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","setPrototypeOf","_register","_util","BulbsPinnedElement","_BulbsHTMLElement","this","apply","arguments","attachedCallback","topOffsetAdjustment","parseInt","getAttribute","lastPosition","lastRailHeight","animationRequest","car","querySelector","document","createElement","moveChildren","appendChild","boundPositionCar","positionCar","bind","window","addEventListener","detachedCallback","removeEventListener","getBoundingRects","getRoundedBoundingClientRect","parent","parentElement","rail","isInView","boundingRects","InViewMonitor","isElementInViewport","_this2","requestAnimationFrame","style","height","Math","abs","top","width","hasNewRailHeight","resetCarPosition","isScrollingDown","handleScrollDown","handleScrollUp","newRailHeight","offset","getScrollOffset","scrollDown","y","bottom","pinToRailBottom","pinToWindow","classList","remove","add","BulbsHTMLElement","default","registerElement","261"],"mappings":"AAAAA,cAAc,KAERC,EACA,SAASC,EAAQC,EAASC,GAE/B,YAYA,SAASC,GAAUC,EAAKC,GAA6D,IAAK,GAAlDC,GAAOC,OAAOC,oBAAoBH,GAAoBI,EAAI,EAAGA,EAAIH,EAAKI,OAAQD,IAAK,CAAE,GAAIE,GAAML,EAAKG,GAAQG,EAAQL,OAAOM,yBAAyBR,EAAUM,EAAUC,IAASA,EAAME,cAA6BC,SAAbX,EAAIO,IAAsBJ,OAAOS,eAAeZ,EAAKO,EAAKC,GAAY,MAAOR,GAE5T,QAASa,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMC,GAAQ,IAAKD,EAAQ,KAAM,IAAIE,gBAAe,4DAAgE,QAAOD,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BD,EAAPC,EAElO,QAASE,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIP,WAAU,iEAAoEO,GAAeD,GAASE,UAAYrB,OAAOsB,OAAOF,GAAcA,EAAWC,WAAaE,aAAelB,MAAOc,EAAUK,YAAY,EAAOC,UAAU,EAAMlB,cAAc,KAAea,IAAYpB,OAAO0B,eAAiB1B,OAAO0B,eAAeP,EAAUC,GAAcxB,EAAUuB,EAAUC,IAhBhepB,OAAOS,eAAef,EAAS,cAC7BW,OAAO,GCRV,IAAAsB,GAAAhC,EAAA,GAIAiC,EAAAjC,EAAA,IAMAA,GAAA,IDeC,ICboBkC,GDaK,SAAUC,GAGjC,QAASD,KAGP,MAFAnB,GAAgBqB,KAAMF,GAEff,EAA2BiB,KAAMD,EAAkBE,MAAMD,KAAME,YAwIxE,MA7IAf,GAAUW,EAAoBC,GAQ9BD,EAAmBR,UCpBpBa,iBDoBiD,WClB/CH,KAAKI,oBAAsBC,SAASL,KAAKM,aAAa,kBAAoB,EAAG,IAC7EN,KAAKO,aAAe,EACpBP,KAAKQ,eAAiB,EACtBR,KAAKS,iBAAmB,IAExB,IAAIC,GAAMV,KAAKW,cAAc,2BACzBD,GACFV,KAAKU,IAAMA,GAGXV,KAAKU,IAAME,SAASC,cAAc,6BAClC,EAAAhB,EAAAiB,cAAad,KAAMA,KAAKU,KACxBV,KAAKe,YAAYf,KAAKU,MAGxBV,KAAKgB,iBAAmBhB,KAAKiB,YAAYC,KAAKlB,MAE9CmB,OAAOC,iBAAiB,SAAUpB,KAAKgB,kBAEvChB,KAAKgB,oBDsBNlB,EAAmBR,UCnBpB+B,iBDmBiD,WClB/CF,OAAOG,oBAAoB,SAAUtB,KAAKgB,mBDsB3ClB,EAAmBR,UCnBpBiC,iBDmBiD,WCjB/C,OACEb,KAAK,EAAAb,EAAA2B,8BAA6BxB,KAAKU,KACvCe,QAAQ,EAAA5B,EAAA2B,8BAA6BxB,KAAK0B,eAC1CC,MAAM,EAAA9B,EAAA2B,8BAA6BxB,QDuBtCF,EAAmBR,UCnBpBsC,SDmByC,SCnB/BC,GACR,MAAOhC,GAAAiC,cAAcC,oBAAoB/B,KAAM6B,EAAcF,ODsB9D7B,EAAmBR,UCnBpB2B,YDmB4C,WCnB7B,GAAAe,GAAAhC,IACTA,MAAKS,mBACPT,KAAKS,iBAAmBwB,sBAAsB,WAC5CD,EAAKvB,iBAAmB,IAExB,IAAMoB,GAAgBG,EAAKT,kBAE3BS,GAAKE,MAAMC,OAAYN,EAAcJ,OAAOU,OAASC,KAAKC,IAAIR,EAAcJ,OAAOa,IAAMT,EAAcF,KAAKW,KAA5G,KACAN,EAAKE,MAAMK,MAAWV,EAAcJ,OAAOc,MAA3C,KAEIP,EAAKQ,iBAAiBX,IACxBG,EAAKS,mBAGHT,EAAKJ,SAASC,KAEbG,EAAKU,kBACNV,EAAKW,iBAAiBd,GAGtBG,EAAKY,eAAef,QD2B7B/B,EAAmBR,UCpBpBkD,iBDoBiD,SCpB/BX,GAChB,GAAIgB,IAAgB,CAOpB,OALIhB,GAAcF,KAAKQ,SAAWnC,KAAKQ,iBACrCqC,GAAgB,EAChB7C,KAAKQ,eAAiBqB,EAAcF,KAAKQ,QAGpCU,GDuBR/C,EAAmBR,UCpBpBoD,gBDoBgD,WCnB9C,GAAMI,IAAS,EAAAjD,EAAAkD,mBAEXC,GAAa,CAOjB,OANIF,GAAOG,EAAIjD,KAAKO,eAClByC,GAAa,GAGfhD,KAAKO,aAAeuC,EAAOG,EAEpBD,GDuBRlD,EAAmBR,UCpBpBqD,iBDoBiD,SCpB/Bd,GAEZA,EAAcF,KAAKuB,QAAUrB,EAAcnB,IAAIwC,OACjDlD,KAAKmD,kBAEEtB,EAAcF,KAAKW,IAAMtC,KAAKI,qBAAuB,GAC5DJ,KAAKoD,eDuBRtD,EAAmBR,UCnBpBsD,eDmB+C,SCnB/Bf,GAEVA,EAAcF,KAAKW,KAAOT,EAAcnB,IAAI4B,IAC9CtC,KAAKyC,mBAEEZ,EAAcF,KAAKuB,OAASrB,EAAcnB,IAAIyB,OAASnC,KAAKI,qBAAuB,GAC1FJ,KAAKoD,eDsBRtD,EAAmBR,UClBpBmD,iBDkBiD,WCjB/CzC,KAAKU,IAAI2C,UAAUC,OAAO,SAAU,iBAEpCtD,KAAKU,IAAIwB,MAAMgB,OAAS,GACxBlD,KAAKU,IAAIwB,MAAMI,IAAM,GDqBtBxC,EAAmBR,UClBpB6D,gBDkBgD,WCjB9CnD,KAAKU,IAAI2C,UAAUC,OAAO,UAC1BtD,KAAKU,IAAI2C,UAAUE,IAAI,iBAEvBvD,KAAKU,IAAIwB,MAAMgB,OAAS,EACxBlD,KAAKU,IAAIwB,MAAMI,IAAM,IDqBtBxC,EAAmBR,UClBpB8D,YDkB4C,WCjB1CpD,KAAKU,IAAI2C,UAAUC,OAAO,iBAC1BtD,KAAKU,IAAI2C,UAAUE,IAAI,UAEvBvD,KAAKU,IAAIwB,MAAMgB,OAAS,GACxBlD,KAAKU,IAAIwB,MAAMI,IAAStC,KAAKI,oBAA7B,MDqBMN,GACPF,EAAU4D,iBAEZ7F,GAAQ8F,QC9JY3D,GA0IrB,EAAAF,EAAA8D,iBAAgB,uBAAwB5D,ID2BlC6D,IACA,SAASjG,EAAQC","file":"bulbs-pinned-element.js","sourcesContent":["webpackJsonp([13],{\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _register = __webpack_require__(2);\n\t\n\tvar _util = __webpack_require__(190);\n\t\n\t__webpack_require__(261);\n\t\n\tfunction _defaults(obj, defaults) { var keys = Object.getOwnPropertyNames(defaults); for (var i = 0; i < keys.length; i++) { var key = keys[i]; var value = Object.getOwnPropertyDescriptor(defaults, key); if (value && value.configurable && obj[key] === undefined) { Object.defineProperty(obj, key, value); } } return obj; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass); }\n\t\n\tvar BulbsPinnedElement = function (_BulbsHTMLElement) {\n\t  _inherits(BulbsPinnedElement, _BulbsHTMLElement);\n\t\n\t  function BulbsPinnedElement() {\n\t    _classCallCheck(this, BulbsPinnedElement);\n\t\n\t    return _possibleConstructorReturn(this, _BulbsHTMLElement.apply(this, arguments));\n\t  }\n\t\n\t  BulbsPinnedElement.prototype.attachedCallback = function attachedCallback() {\n\t\n\t    this.topOffsetAdjustment = parseInt(this.getAttribute('offset-top-px') || 0, 10);\n\t    this.lastPosition = 0;\n\t    this.lastRailHeight = 0;\n\t    this.animationRequest = null;\n\t\n\t    var car = this.querySelector('bulbs-pinned-element-car');\n\t    if (car) {\n\t      this.car = car;\n\t    } else {\n\t      this.car = document.createElement('bulbs-pinned-element-car');\n\t      (0, _util.moveChildren)(this, this.car);\n\t      this.appendChild(this.car);\n\t    }\n\t\n\t    this.boundPositionCar = this.positionCar.bind(this);\n\t\n\t    window.addEventListener('scroll', this.boundPositionCar);\n\t\n\t    this.boundPositionCar();\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.detachedCallback = function detachedCallback() {\n\t    window.removeEventListener('scroll', this.boundPositionCar);\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.getBoundingRects = function getBoundingRects() {\n\t\n\t    return {\n\t      car: (0, _util.getRoundedBoundingClientRect)(this.car),\n\t      parent: (0, _util.getRoundedBoundingClientRect)(this.parentElement),\n\t      rail: (0, _util.getRoundedBoundingClientRect)(this)\n\t    };\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.isInView = function isInView(boundingRects) {\n\t    return _util.InViewMonitor.isElementInViewport(this, boundingRects.rail);\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.positionCar = function positionCar() {\n\t    var _this2 = this;\n\t\n\t    if (!this.animationRequest) {\n\t      this.animationRequest = requestAnimationFrame(function () {\n\t        _this2.animationRequest = null;\n\t\n\t        var boundingRects = _this2.getBoundingRects();\n\t\n\t        _this2.style.height = boundingRects.parent.height - Math.abs(boundingRects.parent.top - boundingRects.rail.top) + 'px';\n\t        _this2.style.width = boundingRects.parent.width + 'px';\n\t\n\t        if (_this2.hasNewRailHeight(boundingRects)) {\n\t          _this2.resetCarPosition();\n\t        }\n\t\n\t        if (_this2.isInView(boundingRects)) {\n\t\n\t          if (_this2.isScrollingDown()) {\n\t            _this2.handleScrollDown(boundingRects);\n\t          } else {\n\t            _this2.handleScrollUp(boundingRects);\n\t          }\n\t        }\n\t      });\n\t    }\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.hasNewRailHeight = function hasNewRailHeight(boundingRects) {\n\t    var newRailHeight = false;\n\t\n\t    if (boundingRects.rail.height !== this.lastRailHeight) {\n\t      newRailHeight = true;\n\t      this.lastRailHeight = boundingRects.rail.height;\n\t    }\n\t\n\t    return newRailHeight;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.isScrollingDown = function isScrollingDown() {\n\t    var offset = (0, _util.getScrollOffset)();\n\t\n\t    var scrollDown = false;\n\t    if (offset.y > this.lastPosition) {\n\t      scrollDown = true;\n\t    }\n\t\n\t    this.lastPosition = offset.y;\n\t\n\t    return scrollDown;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.handleScrollDown = function handleScrollDown(boundingRects) {\n\t\n\t    if (boundingRects.rail.bottom <= boundingRects.car.bottom) {\n\t      this.pinToRailBottom();\n\t    } else if (boundingRects.rail.top - this.topOffsetAdjustment <= 0) {\n\t      this.pinToWindow();\n\t    }\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.handleScrollUp = function handleScrollUp(boundingRects) {\n\t\n\t    if (boundingRects.rail.top >= boundingRects.car.top) {\n\t      this.resetCarPosition();\n\t    } else if (boundingRects.rail.bottom - boundingRects.car.height - this.topOffsetAdjustment >= 0) {\n\t      this.pinToWindow();\n\t    }\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.resetCarPosition = function resetCarPosition() {\n\t    this.car.classList.remove('pinned', 'pinned-bottom');\n\t\n\t    this.car.style.bottom = '';\n\t    this.car.style.top = 0;\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.pinToRailBottom = function pinToRailBottom() {\n\t    this.car.classList.remove('pinned');\n\t    this.car.classList.add('pinned-bottom');\n\t\n\t    this.car.style.bottom = 0;\n\t    this.car.style.top = '';\n\t  };\n\t\n\t  BulbsPinnedElement.prototype.pinToWindow = function pinToWindow() {\n\t    this.car.classList.remove('pinned-bottom');\n\t    this.car.classList.add('pinned');\n\t\n\t    this.car.style.bottom = '';\n\t    this.car.style.top = this.topOffsetAdjustment + 'px';\n\t  };\n\t\n\t  return BulbsPinnedElement;\n\t}(_register.BulbsHTMLElement);\n\t\n\texports.default = BulbsPinnedElement;\n\t\n\t\n\t(0, _register.registerElement)('bulbs-pinned-element', BulbsPinnedElement);\n\n/***/ },\n\n/***/ 261:\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }\n\n});\n\n\n// WEBPACK FOOTER //\n// bulbs-pinned-element.js","import {\n  registerElement,\n  BulbsHTMLElement,\n} from 'bulbs-elements/register';\nimport {\n  InViewMonitor,\n  getRoundedBoundingClientRect,\n  getScrollOffset,\n  moveChildren,\n} from 'bulbs-elements/util';\nimport './bulbs-pinned-element.scss';\n\nexport default class BulbsPinnedElement extends BulbsHTMLElement {\n\n  attachedCallback () {\n\n    this.topOffsetAdjustment = parseInt(this.getAttribute('offset-top-px') || 0, 10);\n    this.lastPosition = 0;\n    this.lastRailHeight = 0;\n    this.animationRequest = null;\n\n    let car = this.querySelector('bulbs-pinned-element-car');\n    if (car) {\n      this.car = car;\n    }\n    else {\n      this.car = document.createElement('bulbs-pinned-element-car');\n      moveChildren(this, this.car);\n      this.appendChild(this.car);\n    }\n\n    this.boundPositionCar = this.positionCar.bind(this);\n\n    window.addEventListener('scroll', this.boundPositionCar);\n\n    this.boundPositionCar();\n  }\n\n  detachedCallback () {\n    window.removeEventListener('scroll', this.boundPositionCar);\n  }\n\n  getBoundingRects () {\n\n    return {\n      car: getRoundedBoundingClientRect(this.car),\n      parent: getRoundedBoundingClientRect(this.parentElement),\n      rail: getRoundedBoundingClientRect(this),\n    };\n  }\n\n  isInView (boundingRects) {\n    return InViewMonitor.isElementInViewport(this, boundingRects.rail);\n  }\n\n  positionCar () {\n    if(!this.animationRequest) {\n      this.animationRequest = requestAnimationFrame(() => {\n        this.animationRequest = null;\n\n        const boundingRects = this.getBoundingRects();\n\n        this.style.height = `${boundingRects.parent.height - Math.abs(boundingRects.parent.top - boundingRects.rail.top)}px`;\n        this.style.width = `${boundingRects.parent.width}px`;\n\n        if (this.hasNewRailHeight(boundingRects)) {\n          this.resetCarPosition();\n        }\n\n        if (this.isInView(boundingRects)) {\n\n          if(this.isScrollingDown()) {\n            this.handleScrollDown(boundingRects);\n          }\n          else {\n            this.handleScrollUp(boundingRects);\n          }\n        }\n      });\n    }\n  }\n\n  hasNewRailHeight (boundingRects) {\n    let newRailHeight = false;\n\n    if (boundingRects.rail.height !== this.lastRailHeight) {\n      newRailHeight = true;\n      this.lastRailHeight = boundingRects.rail.height;\n    }\n\n    return newRailHeight;\n  }\n\n  isScrollingDown () {\n    const offset = getScrollOffset();\n\n    let scrollDown = false;\n    if (offset.y > this.lastPosition) {\n      scrollDown = true;\n    }\n\n    this.lastPosition = offset.y;\n\n    return scrollDown;\n  }\n\n  handleScrollDown (boundingRects) {\n\n    if (boundingRects.rail.bottom <= boundingRects.car.bottom) {\n      this.pinToRailBottom();\n    }\n    else if (boundingRects.rail.top - this.topOffsetAdjustment <= 0) {\n      this.pinToWindow();\n    }\n  }\n\n  handleScrollUp (boundingRects) {\n\n    if (boundingRects.rail.top >= boundingRects.car.top) {\n      this.resetCarPosition();\n    }\n    else if (boundingRects.rail.bottom - boundingRects.car.height - this.topOffsetAdjustment >= 0) {\n      this.pinToWindow();\n    }\n  }\n\n  resetCarPosition () {\n    this.car.classList.remove('pinned', 'pinned-bottom');\n\n    this.car.style.bottom = '';\n    this.car.style.top = 0;\n  }\n\n  pinToRailBottom () {\n    this.car.classList.remove('pinned');\n    this.car.classList.add('pinned-bottom');\n\n    this.car.style.bottom = 0;\n    this.car.style.top = '';\n  }\n\n  pinToWindow () {\n    this.car.classList.remove('pinned-bottom');\n    this.car.classList.add('pinned');\n\n    this.car.style.bottom = '';\n    this.car.style.top = `${this.topOffsetAdjustment}px`;\n  }\n}\n\nregisterElement('bulbs-pinned-element', BulbsPinnedElement);\n\n\n\n\n// WEBPACK FOOTER //\n// ./elements/bulbs-pinned-element/bulbs-pinned-element.js"],"sourceRoot":""}