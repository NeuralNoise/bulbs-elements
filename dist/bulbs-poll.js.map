{"version":3,"sources":["webpack:///./elements/bulbs-poll/bulbs-poll.js","webpack:///./elements/bulbs-poll/store.js","webpack:///./elements/bulbs-poll/fields/poll.js","webpack:///./elements/bulbs-poll/fields/selected-answer.js","webpack:///./elements/bulbs-poll/fields/vote.js","webpack:///./elements/bulbs-poll/components/question.js","webpack:///./elements/bulbs-poll/components/cover.js","webpack:///./elements/bulbs-poll/components/answers.js","webpack:///./elements/bulbs-poll/components/vote-button.js"],"names":[],"mappings":"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","file":"dist/bulbs-poll.js","sourcesContent":["import React, { PropTypes } from 'react';\nimport register from 'bulbs-elements/register';\nimport BulbsElement from 'bulbs-elements/bulbs-element';\n\nimport PollStore from './store';\n\nimport PollQuestion from './components/question';\nimport PollResults from './components/results';\n\nclass BulbsPoll extends BulbsElement {\n  initialDispatch () {\n    this.store.actions.fetchPollData(this.props.src);\n  }\n\n  render () {\n    return <PollQuestion\n      actions={this.store.actions}\n      data={this.state}\n    />\n  }\n}\n\nBulbsPoll.store = PollStore;\n\nBulbsPoll.propTypes = {\n  src: PropTypes.string.isRequired,\n};\n\nregister('bulbs-poll', BulbsPoll);\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/bulbs-poll.js\n **/","import { Store } from 'bulbs-elements/store';\n\nimport PollField from './fields/poll';\nimport SelectedAnswerField from './fields/selected-answer';\nimport VoteField from './fields/vote';\n\nexport default class PollStore extends Store { }\n\nStore.defineFields(PollStore, {\n  poll: PollField,\n  selectedAnswer: SelectedAnswerField,\n  vote: VoteField,\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/store.js\n **/","import { Field, Action } from 'bulbs-elements/store';\n\nconst PollField = new Field({\n  initialState: {\n    data: {\n      answers: [],\n    },\n    requestInFlight: false,\n  },\n  fetchPollData: new Action(function (state, src, store) {\n    let request = this.request(src);\n\n    request.success(store.actions.fetchPollDataSuccess);\n    request.failure(store.actions.fetchPollDataFailure);\n    request.error(store.actions.fetchPollDataError);\n\n    state.requestInFlight = true;\n    return state;\n  }),\n  fetchPollDataSuccess: new Action(function (state, data) {\n    state.data = data;\n    state.requestInFlight = false;\n    return state;\n  }),\n  fetchPollDataFailure: new Action(function (state, failure) {\n    state.failure = failure;\n    state.requestInFlight = false;\n    return state;\n  }),\n  fetchPollDataError: new Action(function (state, error) {\n    state.requestError = error;\n    state.requestInFlight = false;\n    return state;\n  }),\n});\n\nexport default PollField;\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/fields/poll.js\n **/","import { Field, Action } from 'bulbs-elements/store';\n\nconst SelectedAnswerField = new Field({\n  initialState: null,\n  selectAnswer: new Action(function (state, answer) {\n    return (state && state.id === answer.id) ? null : answer;\n  }),\n});\n\nexport default SelectedAnswerField;\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/fields/selected-answer.js\n **/","import { Field, Action } from 'bulbs-elements/store';\n\nconst VoteField = new Field({\n  initialState: {},\n  getCachedVoteData: new Action(function (state, poll) {\n    state.data = localStorage.getItem(`bulbs-poll:vote:${poll.data.id}`);\n    return state;\n  }),\n  makeVoteRequest: new Action(function (state, answer, store) {\n    let { poll } = store.state;\n    let request = this.request(`http://onion.soadhead.com/api/polls/${poll.data.id}`, {\n      method: 'post',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        /* convert answer into vote data */\n      }),\n    });\n\n    request.success(store.actions.fetchPollDataSuccess);\n    request.failure(store.actions.fetchPollDataFailure);\n    request.error(store.actions.fetchPollDataError);\n\n    state.requestInFlight = true;\n    return state;\n  }),\n  voteRequestSuccess: new Action(function (state, data) {\n    state.data = data.vote;\n    state.requestInFlight = false;\n    return state;\n  }),\n  voteRequestFailure: new Action(function (state, failure) {\n    state.failure = failure;\n    state.requestInFlight = false;\n  }),\n  voteRequestError: new Action(function (state, error) {\n    state.requestInFlight = false;\n    state.requestError = error;\n    return state;\n  }),\n});\n\nexport default VoteField;\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/fields/vote.js\n **/","import React, { PropTypes } from 'react';\n\nimport Cover from './cover';\nimport Answers from './answers';\nimport VoteButton from './vote-button';\n\nexport default function Question (props) {\n  let {\n    selectAnswer,\n    makeVoteRequest,\n  } = props.actions;\n\n  let {\n    poll,\n    selectedAnswer,\n    vote,\n  } = props.data;\n\n  let voteButton = null;\n  if (!vote.data) {\n    voteButton = <VoteButton\n      selectedAnswer={selectedAnswer}\n      makeVoteRequest={makeVoteRequest}\n    />;\n  }\n\n  return (\n    <div className=\"bulbs-poll\">\n      <Cover poll={poll} />\n      <Answers\n        answers={poll.data.answers}\n        selectAnswer={selectAnswer}\n        selectedAnswer={selectedAnswer}\n      />\n      { voteButton }\n    </div>\n  );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/components/question.js\n **/","import React, { PropTypes } from 'react';\nimport CroppedImage from 'bulbs-elements/components/cropped-image';\n\nexport default function Cover (props) {\n  let { poll } = props;\n  return (\n    <header className=\"bulbs-poll-cover\">\n      {\n        poll.data.thumbnail ? <CroppedImage image={poll.data.thumbnail} /> : null\n      }\n      <h1 className=\"bulbs-poll-title\">\n        { poll.data.question_text }\n      </h1>\n    </header>\n  );\n}\n\nCover.propTypes = {\n  poll: PropTypes.object.isRequired,\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/components/cover.js\n **/","import React, { PropTypes } from 'react';\nimport classnames from 'classnames';\n\nexport default function Answers (props) {\n  return (\n    <ul className=\"bulbs-poll-answers\">\n      {\n        props.answers.map((answer, index) => {\n          return <Answer\n            key={index}\n            answer={answer}\n            {...props}\n          />;\n        })\n      }\n    </ul>\n  );\n}\n\nAnswers.propTypes = {\n  answers: PropTypes.array.isRequired,\n  selectAnswer: PropTypes.func.isRequired,\n  selectedAnswer: PropTypes.object,\n};\n\nexport function Answer (props) {\n  let {\n    answer,\n    selectAnswer,\n    selectedAnswer,\n  } = props;\n\n  let className = classnames('bulbs-poll-answer', {\n    selected: answer === selectedAnswer,\n  });\n\n  return (\n    <li\n      className={className}\n      onClick={selectAnswer.bind(null, answer)}\n    >\n      { answer.answer_text }\n    </li>\n  );\n}\n\nAnswer.propTypes = {\n  answer: PropTypes.object.isRequired,\n  selectAnswer: PropTypes.func.isRequired,\n  selectedAnswer: PropTypes.object,\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/components/answers.js\n **/","import React, { PropTypes } from 'react';\n\nexport default function VoteButton (props) {\n  function handleClick () {\n    if (props.selectedAnswer) {\n      props.makeVoteRequest(props.selectedAnswer);\n    }\n  }\n\n  return (\n    <button\n      className=\"bulbs-poll-vote\"\n      onClick={handleClick}\n    >\n      Vote\n    </button>\n  );\n}\n\nVoteButton.propTypes = {\n  makeVoteRequest: PropTypes.func,\n  selectedAnswer: PropTypes.object,\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./elements/bulbs-poll/components/vote-button.js\n **/"],"sourceRoot":""}